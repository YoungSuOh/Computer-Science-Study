# 인터럽트

> 프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우, **`현재 실행중인 작업을 즉시 중단`**하고, **`발생된 상황에 대한 우선 처리가 필요함을 CPU에게 알리는 것`**
> 

외부 / 내부 인터럽트는 CPU의 `하드웨어 신호`에 의해 발생

- 외부 인터럽트
    - ex) 입출력, 외부 신호, 전원 이상 등
- 내부 인터럽트
    - Trap이라고 부르며, 잘못된 명령이나 데이터를 사용할 때 발생
    - ex) 0으로 나누기가 발생, 오버플로우, 명령어를 잘못 사용한 경우(Exception)

소프트웨어 인터럽트는 `명령어의 수행`에 의해 발생

- 소프트웨어 인터럽트
    - 프로그램 처리 중 명령의 요청에 의해 발생한 것
    - 사용자가 프로그램을 실행 시킬 때 발생

## 컴퓨터 시스템의 자원의 현 상태를 파악하는 방법

### Polling

- CPU가 일정한 시간 간격을 두고 각 자원들의 상태를 주기적으로 확인하는 방식
- 자원이 `polling` 신호를 받으면 자신의 상태를 적어놓을 수 있는 곳에 저장시키고, CPU는 폴링 때 그것을 읽어보는 방식이다.
- 교수님이 10분마다 학생들에게 질문 있니 물어보는 것
- 아무 일이 없어도 CPU는 폴링에 일정 시간을 들여야 한다 ⇒ 치명적 단점이라 안씀

### Interrupt

- 각 자원들이 능동적으로 자신의 상태 변화를 CPU에 알리는 방식
- MCU 자체가 하드웨어적으로 변화를 체크하여 변화 시에만 일정한 동작을 하는 방식
    - MCU → 마이크로 컨트롤러 유닛
- CPU는 따로 시간을 들이지 않아도 되고, 자원들은 변화가 발생하면 즉시 알려 처리할 수 있다.
- 학생들이 질문 생길 때마다 교수님께 여쭤보는 것
- 인터럽트 방식은 하드웨어로 지원을 받아야 하는 제약이 있지만, 폴링에 비해 신속하게 대응하는 것이 가능
- 즉, 인터럽트는 **발생시기를 예측하기 힘든 경우에 컨트롤러가 가장 빠르게 대응할 수 있는 방법**이다.

### 인터럽트 처리 과정

1. CPU가 인터럽트를 확인하면 인터럽트 처리 루틴을 실행시켜야 한다.
    1. 그전에 현 상태의 정보(레지스터 값)를 시스템 스택에 저장한다
2. 인터럽트 처리 루틴의 시작 주소를 PC에 넣고 실행한다
3. 루틴 실행이 끝나면 레지스터에 값을 복원하고, 프로그램의 실행을 계속 이어나간다. 여기서 현 상태의 정보를 임시로 저장해두고 다시 복원하는 과정을 `문맥 교환(Context Switch)`이라고 한다.

요약 :  `인터럽트`가 발생했을 때, 현재 실행 중이던 함수나 루틴은 CPU 레지스터에 저장하고 인터럽트 루틴을 실행하다가 루틴이 끝나면 CPU 레지스터에서 다시 메모리로 돌아가서 다시 실행된다