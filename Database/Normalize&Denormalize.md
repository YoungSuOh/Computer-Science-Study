# 정규화

정규화란 데이터베이스 설계에서 데이터의 중복을 줄이고, 데이터 무결성을 유지하기 위해  데이터를 구조화하는 과정이다.

## 정규화의 목적

1. 데이터 중복 제거
2. 데이터 무결성 유지
3. 갱신 이상 최소화
    1. 삽입, 삭제, 갱신 작업 중 발생할 수 있는 이상 현상(anomaly)을 줄임
4. 확장성 향상

## 정규화 단계

### 제1정규형

<aside>
💡

도메인이 **원자값(atomic value)**만 포함하도록 변환 (기본키 잡기)

</aside>

- 비정규형
    
    
    | 학생 ID | 이름 | 수강 과목 |
    | --- | --- | --- |
    | 1 | 홍길동 | 수학, 영어 |
    | 2 | 김철수 | 과학 |
- 1NF 변환
    
    
    | 학생 ID | 이름 | 수강 과목 |
    | --- | --- | --- |
    | 1 | 홍길동 | 수학 |
    | 1 | 홍길동 | 영어 |
    | 2 | 김철수 | 과학 |



### 제2정규형

<aside>
💡

부분 함수 종속 제거

</aside>



## 제3정규형

<aside>
💡

이행 함수 종속 제거

</aside>



## BCNF (Boyce-Codd Normal Form)

<aside>
💡

**모든 결정자가 후보 키**(Candidate Key)이어야 한다

</aside>



## 정규화를 적용할 때  판단 기준

### 데이터 성격 및 사용 패턴 분석

1. **읽기와 쓰기 비중 분석**
    - **읽기가 많은 경우**: 조인을 최소화하고 일부 비정규화를 허용.(예: 데이터 분석 시스템, 대시보드)
    - **쓰기가 많은 경우**: 정규화를 적용해 데이터 무결성을 유지.(예: 금융, 거래 시스템)
2. **데이터 변경 빈도**
    - 데이터가 자주 수정되거나 삭제되는 경우, 높은 정규화를 적용해 데이터 이상 방지.
    - 데이터가 거의 변경되지 않는 경우, 낮은 정규화나 비정규화로 읽기 성능 최적화.

### 프로젝트 요구사항

1. **데이터 일관성이 중요한 경우**
    - 정규화를 높은 수준(3NF, BCNF)까지 적용.예: 고객 정보, 금융 데이터, 의료 데이터.
2. **빠른 읽기 성능이 중요한 경우**
    - 일부 비정규화를 허용하여 데이터 중복을 허용하고 읽기 성능 최적화.예: 캐시 테이블, 대규모 로그 데이터.
3. **복잡한 관계를 다루는 경우**
    - 관계형 데이터베이스의 특성을 살려 정규화를 충분히 적용.예: 전자상거래 시스템의 주문-제품 관계.

### **데이터베이스 확장성**

1. **수직 확장(Scale-up)**
    - 단일 서버에서 성능을 개선하는 경우, 정규화를 통해 데이터를 최적화.예: 전통적인 관계형 데이터베이스 시스템.
2. **수평 확장(Scale-out)**
    - 여러 서버에 데이터를 분산해야 한다면, 일부 비정규화를 통해 데이터 복제를 허용.예: 분산 데이터베이스(NoSQL).

# 반정규화

반정규화(Denormalization)는 **정규화된 데이터베이스의 일부를 의도적으로 정규화 원칙에서 벗어나게 설계**하여 성능을 최적화하는 기법

- 주로 읽기 성능(Read Performance)을 개선하기 위해 사용되며, **데이터 중복**을 허용하거나 **중복 테이블/컬럼을 추가**하여 데이터를 조회하는 비용을 줄이는 방식
- 정규화로 인해 발생하는 **조인 연산**이나 복잡한 쿼리를 줄이는 데 초점이 맞춰져 있다.

### 반정규화의 주요 기법

- **테이블 병합**
    - 여러 테이블을 조인해서 자주 사용하는 데이터를 하나의 테이블로 통합.
    - 예) 고객 테이블과 주문 테이블을 병합하여 고객-주문 정보 조회 성능 개선.
- **중복 컬럼 추가**
    - 조회 시 자주 필요한 데이터를 다른 테이블에 중복 저장.
    - 예) 주문 테이블에 고객 이름과 주소를 중복 저장.
- **계산된 컬럼 추가**
    - 쿼리에서 자주 계산되는 값을 미리 컬럼에 저장.
    - 예) 총 주문 금액(total_price)을 주문 항목 테이블에서 계산하지 않고 주문 테이블에 저장.
- **중복 테이블 추가**
    - 특정 데이터를 빠르게 조회하기 위해 중복 데이터를 가진 테이블을 별도로 생성.
    - 예) 대시보드에서 사용하는 요약 데이터를 별도 테이블로 관리.

### 반정규화를 사용할 때 장단점

| 장점 | 단점 |
| --- | --- |
| 읽기 성능 개선 (join  연산 감소) | 데이터 중복으로 인해 저장 공간 증가 |
| 쿼리 복잡성 감소, 응답 속도 향상 | 데이터 일관성 유지가 어려워짐 (중복된 데이터가 여러  테이블에 저장되므로 동기화 필요) |
| 실시간 서비스나 대용량 데이터  처리 시스템에서 효과적 | 데이터 삽입, 수정, 삭제 작업이 복잡해지고 비용이 증가 |
| 특정 비즈니스 요구사항을 충족 | 유지보수 복잡성이 증가 (데이터 중복이 많아질수록 개발 및 관리 난이도 증가) |